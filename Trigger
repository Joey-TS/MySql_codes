Q. Using MySQL, create a table BANK with the columns ACCOUNT_NO PRIMARY KEY, ACCOUNT_NAME, BALANCE INT DEFAULT (0).

Also create a table ACCOUNT with the columns : ACCOUNT_NO PRIMARY KEY FOREIGN KEY REFERENCES ACCOUNT_NO FROM BANK, AMOUNT, TRANSACTION

Then create a trigger to update the values of the account BALANCE as per the transaction. If the transaction is of the type “DEPOSIT” then add the amount to the existing balance. Else, if the type is “WITHDRAWAL” then deduct the balance.

Ans>

CREATE TABLE BANK (
ACCOUNT_NO INT PRIMARY KEY,
ACCOUNT_NAME VARCHAR(100),
BALANCE INT DEFAULT 0
);

CREATE TABLE ACCOUNT (
ACCOUNT_NO INT,
AMOUNT INT,
TRANSACTION ENUM('DEPOSIT', 'WITHDRAWAL'),
PRIMARY KEY (ACCOUNT_NO, AMOUNT, TRANSACTION),
FOREIGN KEY (ACCOUNT_NO) REFERENCES BANK(ACCOUNT_NO)
);

DELIMITER //

CREATE TRIGGER update_balance
AFTER INSERT ON ACCOUNT
FOR EACH ROW
BEGIN
IF NEW.TRANSACTION = 'DEPOSIT' THEN
UPDATE BANK
SET BALANCE = BALANCE + NEW.AMOUNT
WHERE ACCOUNT_NO = NEW.ACCOUNT_NO;
ELSEIF NEW.TRANSACTION = 'WITHDRAWAL' THEN
UPDATE BANK
SET BALANCE = BALANCE - NEW.AMOUNT
WHERE ACCOUNT_NO = NEW.ACCOUNT_NO;
END IF;
END //

DELIMITER ;
